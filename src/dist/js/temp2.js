"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FileReadException(t){alert("Erro! Abra o console para saber mais."),this.message=t,this.name="FileReadException"}function PointCoordinateParseException(t){alert("Erro! Abra o console para saber mais."),this.message=t,this.name="PointCoordinateParseException"}function PointReferenceException(t){alert("Erro! Abra o console para saber mais."),this.message=t,this.name="PointReferenceException"}function PointSumException(t){alert("Erro! Abra o console para saber mais."),this.message=t,this.name="PointSumException"}function MatrixSizeException(t){alert("Erro! Abra o console para saber mais."),this.message=t,this.name="MatrixSizeException"}function MatrixMultiplicationException(t){alert("Erro! Abra o console para saber mais."),this.message=t,this.name="MatrixMultiplicationException"}function BadColorException(t){alert("Erro! Abra o console para saber mais."),this.message=t,this.name="BadColorException"}function BadBarycentricSum(t){alert("Erro! Abra o console para saber mais."),this.message=t,this.name="BadBarycentricSum"}function DegeneratedTriangle(t){this.message=t,this.name="DegeneratedTriangle"}function capitalize(t){return t[0].toUpperCase()+t.slice(1)}function getObjectName(t){return t=t.split(".")[0],capitalize(t)}function getDistance(t,e){var n=t.coordinates.map(function(t,n){return t-e.coordinates[n]}).reduce(function(t,e){return t+e*e},0);return Math.sqrt(n)}function convert2Dto3D(t,e,n){var o=getBarycentricCoordinates(t,e),r=n.points3D[t.points[0].id],i=n.points3D[t.points[1].id],a=n.points3D[t.points[2].id];return PointOperations.barycentricSum([r,i,a],o,!0)}function computePhongVectorN(t,e,n){var o=getBarycentricCoordinates(e,t),r=n.points3D[e.points[0].id].normalVector,i=n.points3D[e.points[1].id].normalVector,a=n.points3D[e.points[2].id].normalVector,s=o.map(function(t,e){return r.coordinates[e]*o[0]+i.coordinates[e]*o[1]+a.coordinates[e]*o[2]});return new Vector(s[0],s[1],s[2])}function getPhongColor(t,e,n,o){var r=computePhongVectorN(t,n,o);r=r.getNormalizedVector();var i=PointOperations.subtract(scenarioCamera.focus,e);i=i.getNormalizedVector();var a=PointOperations.subtract(scenarioLight.focus,e);a=a.getNormalizedVector();VectorOperations.scalarProduct(r,i)<0&&r.multiply(-1);var s=VectorOperations.scalarProduct(r,a),c=VectorOperations.scalarMultiplication(scenarioLight.ambColor,scenarioLight.ambRefl);if(s<0)return c;var l=VectorOperations.scalarMultiplication(r,2*s);l=(l=VectorOperations.subtract(l,a)).getNormalizedVector();var u=scenarioLight.difConstant*s,p=VectorOperations.componentProduct(scenarioLight.sourceColor,scenarioLight.difVector),f=VectorOperations.scalarMultiplication(p,u),d=VectorOperations.add(c,f),h=VectorOperations.scalarProduct(l,i);if(h<0)return d;var m=Math.pow(h,scenarioLight.rugosity)*scenarioLight.spec;return m=VectorOperations.scalarMultiplication(scenarioLight.sourceColor,m),VectorOperations.add(d,m)}function initializeZBuffer(){zBuffer=[];for(var t=0;t<canvasWidth;++t){zBuffer.push([]);for(var e=0;e<canvasHeight;++e)zBuffer[t].push(new ZBufferData(Number.MAX_VALUE,canvasColor))}}function drawPixel(t,e,n,o,r,i,a){var s=t.createImageData(1,1);s.data[0]=o,s.data[1]=r,s.data[2]=i,s.data[3]=a,t.putImageData(s,e,n)}function drawLine(t,e,n,o,r,i){e=parseInt(e),n=parseInt(n);for(var a=Math.min(e,n),s=Math.max(e,n),c=a;c<=s;++c){var l=new Point2D(c,o),u=convert2Dto3D(r,l,i);if(c<canvasWidth&&c>=0&&o>=0&&o<zBuffer[c].length&&u.coordinates[2]<zBuffer[c][o].distance){zBuffer[c][o].distance=u.coordinates[2];var p=getPhongColor(l,u,r,i);zBuffer[c][o].color=p}}}function drawFlatBottomTriangle(t,e,n,o){var r=e.points,i=r[1].coordinates[0]-r[0].coordinates[0],a=r[1].coordinates[1]-r[0].coordinates[1],s=parseFloat(i/a);i=r[2].coordinates[0]-r[0].coordinates[0],a=r[2].coordinates[1]-r[0].coordinates[1];for(var c=parseFloat(i/a),l=parseFloat(r[0].coordinates[0]),u=parseFloat(r[0].coordinates[0]),p=r[0].coordinates[1];p<=r[1].coordinates[1];++p)drawLine(t,l,u,p,n,o),l+=s,u+=c}function drawFlatTopTriangle(t,e,n,o){var r=e.points,i=r[2].coordinates[0]-r[0].coordinates[0],a=r[2].coordinates[1]-r[0].coordinates[1],s=parseFloat(i/a);i=r[2].coordinates[0]-r[1].coordinates[0],a=r[2].coordinates[1]-r[1].coordinates[1];for(var c=parseFloat(i/a),l=parseFloat(r[2].coordinates[0]),u=parseFloat(r[2].coordinates[0]),p=r[2].coordinates[1];p>=r[0].coordinates[1];--p)drawLine(t,l,u,p,n,o),l-=s,u-=c}function drawTriangleScanLine(t,e,n){e.sortPointsByYX();var o=e.points;if(o[0].coordinates[1]==o[1].coordinates[1])drawFlatTopTriangle(t,e,e,n);else if(o[1].coordinates[1]==o[2].coordinates[1])drawFlatBottomTriangle(t,e,e,n);else{var r=o[1].coordinates[1]-o[0].coordinates[1],i=o[2].coordinates[1]-o[0].coordinates[1],a=parseFloat(r/i);a*=o[2].coordinates[0]-o[0].coordinates[0];var s=parseInt(o[0].coordinates[0]+a),c=o[1].coordinates[1],l=new Point2D(s,c),u=new Triangle2D(o[0],o[1],l),p=new Triangle2D(o[1],l,o[2]);drawFlatBottomTriangle(t,u,e,n),drawFlatTopTriangle(t,p,e,n)}}function drawZBuffer(t){for(var e=0;e<canvasWidth;++e)for(var n=0;n<canvasHeight;++n){for(var o=zBuffer[e][n].color,r=0;r<3;++r)o.coordinates[r]=Math.max(Math.min(parseInt(o.coordinates[r]),255),0);drawPixel(t,e,n,o.coordinates[0],o.coordinates[1],o.coordinates[2],255)}}function drawObject(t){for(var e=t.triangles2D,n=0;n<e.length;++n)drawTriangleScanLine(ctx,e[n],t);drawZBuffer(ctx)}function storeObjectFileContent(t,e){var n=getObjectName(e),o=new Object3D(n),r=t.split("\n"),i=r[0].split(" "),a=parseInt(i[0]),s=parseInt(i[1]);createPoints(a,r,e,o),createTriangles(s,r,e,o);for(var c=0;c<o.points3D.length;++c){var l=o.points3D[c];l.normalVector=l.normalVector.getNormalizedVector()}scenarioObjects.push(o),drawObject(o)}function createPoints(t,e,n,o){for(idx=1;idx<=t;++idx){var r=e[idx].split(" "),i=parseFloat(r[0]),a=parseFloat(r[1]),s=parseFloat(r[2]);if(isNaN(i)||isNaN(a)||isNaN(s)){throw new PointCoordinateParseException("Arquivo "+n+": Ponto "+idx+" com coordenada inválida. Revise o arquivo enviado.")}var c=new Point(i,a,s);(c=(c=toCameraPointOrigin(c)).baseChange(scenarioCamera.transformMatrix)).id=idx-1,c.normalVector=new Vector(0,0,0),o.points3D.push(c);var l=scenarioCamera.dist/scenarioCamera.hx*(c.coordinates[0]/c.coordinates[2]),u=scenarioCamera.dist/scenarioCamera.hy*(c.coordinates[1]/c.coordinates[2]);l=Math.floor((l+1)*(canvasWidth/2)),u=Math.floor(canvasHeight/2*(1-u));var p=new Point2D(l,u);p.id=idx-1,o.points2D.push(p)}}function toCameraPointOrigin(t){var e=new Vector(-scenarioCamera.focus.coordinates[0],-scenarioCamera.focus.coordinates[1],-scenarioCamera.focus.coordinates[2]);return PointOperations.addVector(t,e)}function createTriangles(t,e,n,o){for(;idx<e.length;++idx){var r=e[idx].split(" ");if(r.length<3)0;else{var i=parseInt(r[0]),a=parseInt(r[1]),s=parseInt(r[2]);if(isNaN(i)||isNaN(a)||isNaN(s)||i<1||i>o.points3D.length||a<1||a>o.points3D.length||s<1||a>o.points3D.length){throw new PointReferenceException("Arquivo "+n+": Triângulo "+idx+" com referência para ponto inválida. Revise o arquivo enviado.")}var c=new Triangle3D(o.points3D[i-1],o.points3D[a-1],o.points3D[s-1]);o.triangles3D.push(c);var l=c.normalVector;o.points3D[i-1].normalVector=VectorOperations.add(o.points3D[i-1].normalVector,l),o.points3D[a-1].normalVector=VectorOperations.add(o.points3D[a-1].normalVector,l),o.points3D[s-1].normalVector=VectorOperations.add(o.points3D[s-1].normalVector,l);var u=new Triangle2D(o.points2D[i-1],o.points2D[a-1],o.points2D[s-1]);o.triangles2D.push(u)}}}function storeCameraFileContent(t,e){for(var n=t.split("\n"),o=[],r=function(t){var r=n[t].split(" ").map(function(n){var o=parseFloat(n);if(isNaN(o)){throw new PointCoordinateParseException("Arquivo "+e+": Ponto "+t+" com coordenada inválida. Revise o arquivo enviado.")}return o});o.push(r)},i=0;i<4;++i)r(i);var a=new Point(o[0][0],o[0][1],o[0][2]),s=new Vector(o[1][0],o[1][1],o[1][2]),c=new Vector(o[2][0],o[2][1],o[2][2]),l=o[3][0],u=o[3][1],p=o[3][2];scenarioCamera=new Camera(a,s,c,l,u,p)}function storeLightFileContent(t,e){for(var n=t.split("\n"),o=[],r=0;r<8;++r){var i=n[r].split(" ");o.push(i)}var a=new Point(parseFloat(o[0][0]),parseFloat(o[0][1]),parseFloat(o[0][2]));a=(a=toCameraPointOrigin(a)).baseChange(scenarioCamera.transformMatrix);var s=parseFloat(o[1][0]),c=new Vector(parseFloat(o[2][0]),parseFloat(o[2][1]),parseFloat(o[2][2])),l=parseFloat(o[3][0]),u=new Vector(parseFloat(o[4][0]),parseFloat(o[4][1]),parseFloat(o[4][2])),p=parseFloat(o[5][0]),f=new Vector(parseFloat(o[6][0]),parseFloat(o[6][1]),parseFloat(o[6][2])),d=parseFloat(o[7][0]);scenarioLight=new Illumination(a,s,c,l,u,p,f,d)}function loadFiles(t,e){for(var n=document.getElementById(t).files,o=function(t){var o=n[t],r=new FileReader;r.onload=function(t){var n=t.target.result;e(n,o.name)},r.onerror=function(t){throw new FileReadException("Erro ao carregar arquivo "+o.name+". Selecione arquivos de texto!")},r.readAsText(o)},r=0;r<n.length;++r)o(r)}function validateFilesInputs(){var t=document.getElementById("file-input-field"),e=document.getElementById("camera-input-field"),n=document.getElementById("light-input-field"),o=t.files.length,r=e.files.length,i=n.files.length;return 1==r&&o>0&&i>0}function eraseCanvas(){ctx.clearRect(0,0,canvasWidth,canvasHeight),initializeZBuffer()}function runApp(){validateFilesInputs()?(eraseCanvas(),scenarioObjects=[],loadFiles("camera-input-field",storeCameraFileContent),loadFiles("light-input-field",storeLightFileContent),loadFiles("file-input-field",storeObjectFileContent)):Materialize.toast("Selecione uma câmera, uma iluminação e um ou mais objetos!",4e3)}var zBuffer,scenarioObjects,scenarioCamera,scenarioLight,_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),Triple=function(){function t(e,n,o,r){_classCallCheck(this,t),this.coordinates=[e,n,o],this.isPoint=r}return _createClass(t,[{key:"multiply",value:function(t){var e=this;this.coordinates.forEach(function(n,o){e.coordinates[o]=n*t})}},{key:"toArray",value:function(t){var e=this.coordinates.map(function(t){return t});return t&&e.push(this.isPoint),e}},{key:"baseChange",value:function(t){var e=new Matrix({rows:4,columns:1,matrix:[[this.coordinates[0]],[this.coordinates[1]],[this.coordinates[2]],[this.isPoint]],addDimension:!1}),n=MatrixOperations.multiply(t,e);return this.isPoint?new Point(n.matrix[0][0],n.matrix[1][0],n.matrix[2][0]):new Vector(n.matrix[0][0],n.matrix[1][0],n.matrix[2][0])}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),Point=function(t){function e(t,n,o){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,1))}return _inherits(e,Triple),e}(),Point2D=function t(e,n){_classCallCheck(this,t),this.coordinates=[e,n]},PointOperations=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"subtract",value:function(t,e){var n=t.coordinates.map(function(t,n){return t-e.coordinates[n]});return new Vector(n[0],n[1],n[2])}},{key:"addVector",value:function(t,e){if(t.isPoint&&e.isPoint){throw new PointSumException("Impossível adicionar dois pontos! Use soma baricêntrica.")}var n=t.coordinates.map(function(t,n){return t+e.coordinates[n]});return new Point(n[0],n[1],n[2])}},{key:"scalarMultiplication",value:function(t,e){var n=t.coordinates.map(function(t,n){return t*e[n]});return 2==t.coordinates.length?new Point2D(n[0],n[1]):new Point(n[0],n[1],n[2])}},{key:"barycentricSum",value:function(t,e,n){e.reduce(function(t,e){return t+e},0);var o=t[0].coordinates.map(function(n,o){return t[0].coordinates[o]*e[0]+t[1].coordinates[o]*e[1]+t[2].coordinates[o]*e[2]});return n?new Point(o[0],o[1],o[2]):new Point2D(o[0],o[1])}},{key:"areSamePoint",value:function(t,e){var n=!0;return t.coordinates.forEach(function(t,o){t!=e.coordinates[o]&&(n=!1)}),n}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),Vector=function(t){function e(t,n,o){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,0))}return _inherits(e,Triple),_createClass(e,[{key:"getNorm",value:function(){return Math.sqrt(this.coordinates.reduce(function(t,e){return t+e*e},0))}},{key:"getNormalizedVector",value:function(){var t=this.getNorm(),n=this.coordinates.map(function(e){return e/t});return new e(n[0],n[1],n[2])}}]),e}(),VectorOperations=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"add",value:function(t,e){var n=t.coordinates.map(function(t,n){return t+e.coordinates[n]});return new Vector(n[0],n[1],n[2])}},{key:"subtract",value:function(t,e){var n=t.coordinates.map(function(t,n){return t-e.coordinates[n]});return new Vector(n[0],n[1],n[2])}},{key:"scalarMultiplication",value:function(t,e){var n=new Vector(t.coordinates[0],t.coordinates[1],t.coordinates[2]);return n.coordinates.forEach(function(t,o){n.coordinates[o]=t*e}),n}},{key:"addPoint",value:function(t,e){var n=t.coordinates.map(function(t,n){return t+e.coordinates[n]});return new Point(n[0],n[1],n[2])}},{key:"vectorProjection",value:function(t,e){var n=this.scalarProduct(t,e),o=this.scalarProduct(e,e);return this.scalarMultiplication(e,n/o)}},{key:"scalarProduct",value:function(t,e){return t.coordinates.reduce(function(t,n,o){return t+n*e.coordinates[o]},0)}},{key:"vectorialProduct",value:function(t,e){var n=t.coordinates,o=e.coordinates;return new Vector(n[1]*o[2]-n[2]*o[1],n[2]*o[0]-n[0]*o[2],n[0]*o[1]-n[1]*o[0])}},{key:"componentProduct",value:function(t,e){var n=t.coordinates.map(function(t,n){return t*e.coordinates[n]});return new Vector(n[0],n[1],n[2])}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),Matrix=function(){function t(e){_classCallCheck(this,t),this.rows=e.rows,this.columns=e.columns,e.matrix?(this.matrix=e.matrix,this.validate()):this.initializeMatrix(),e.extraDimension&&this.addExtraDimension()}return _createClass(t,[{key:"addExtraDimension",value:function(){for(var t=0;t<this.rows;++t)this.matrix[t].push(0);var e=new Array(this.columns);e.fill(0),e.push(1),this.matrix.push(e),++this.rows,++this.columns}},{key:"initializeMatrix",value:function(){this.matrix=new Array(this.rows);for(var t=0;t<this.rows;++t)this.matrix[t]=new Array(this.columns)}},{key:"validate",value:function(){for(var t=0;t<this.matrix.length-1;++t)if(this.matrix[t].length!=this.matrix[t+1].length)throw new MatrixSizeException("Matrizes com linhas com diferente número de colunas.")}}]),t}(),MatrixOperations=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"multiply",value:function(e,n){if(e.columns!=n.rows){throw new MatrixMultiplicationException("Can't multiply matrix with "+e.columns+" columns\n                            by matrix with "+n.rows+" rows!")}for(var o=t.getNewMatrix(e.rows,n.columns),r=0;r<o.rows;++r)for(var i=0;i<o.columns;++i)for(var a=0;a<e.columns;++a)o.matrix[r][i]+=e.matrix[r][a]*n.matrix[a][i];return o}},{key:"getNewMatrix",value:function(t,e){for(var n=Array(t),o=0;o<n.length;++o)n[o]=new Array(e),n[o].fill(0);return new Matrix({rows:t,columns:e,matrix:n})}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),Camera=function(){function t(e,n,o,r,i,a){_classCallCheck(this,t),this.focus=e,this.directionVector=n,this.upVector=o,this.dist=r,this.hx=i,this.hy=a,this.initializeCamera()}return _createClass(t,[{key:"initializeCamera",value:function(){this.ortogonalize(),this.directionVector=this.directionVector.getNormalizedVector(),this.upVector=this.upVector.getNormalizedVector(),this.initializeThirdVector(),this.initializeCameraMatrix()}},{key:"ortogonalize",value:function(){var t=VectorOperations.vectorProjection(this.upVector,this.directionVector);this.upVector=VectorOperations.subtract(this.upVector,t)}},{key:"initializeThirdVector",value:function(){this.thirdVector=VectorOperations.vectorialProduct(this.directionVector,this.upVector)}},{key:"initializeCameraMatrix",value:function(){this.transformMatrix=new Matrix({rows:3,columns:3,matrix:[this.thirdVector.toArray(!1),this.upVector.toArray(!1),this.directionVector.toArray(!1)],extraDimension:!0})}}]),t}(),_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),Color=function(){function t(e,n,o){_classCallCheck(this,t),this.rgb={red:e,blue:n,green:o},validateColor()}return _createClass(t,[{key:"validateColor",value:function(){if(isNaN(this.rgb.red))throw new BadColorException("RGB invalid red component!");if(isNaN(this.rgb.green))throw new BadColorException("RGB invalid green component!");if(isNaN(this.rgb.blue))throw new BadColorException("RGB invalid blue component!");this.rgb.red=Math.max(Math.min(this.rgb.red,255),0),this.rgb.green=Math.max(Math.min(this.rgb.green,255),0),this.rgb.blue=Math.max(Math.min(this.rgb.blue,255),0)}}]),t}(),Illumination=function t(e,n,o,r,i,a,s,c){_classCallCheck(this,t),this.focus=e,this.ambRefl=n,this.ambColor=o,this.difConstant=r,this.difVector=i,this.spec=a,this.sourceColor=s,this.rugosity=c},Object3D=function t(e){_classCallCheck(this,t),this.objectName=e,this.triangles3D=[],this.triangles2D=[],this.points3D=[],this.points2D=[]},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),Triangle3D=function(){function t(e,n,o){_classCallCheck(this,t),this.points=[e,n,o],this.calculateNormalVector()}return _createClass(t,[{key:"getArea",value:function(){return this.normalVector.getNorm()/2}},{key:"calculateNormalVector",value:function(){var t=PointOperations.subtract(this.points[2],this.points[0]),e=PointOperations.subtract(this.points[1],this.points[0]);this.normalVector=VectorOperations.vectorialProduct(t,e).getNormalizedVector()}}]),t}(),Triangle2D=function(){function t(e,n,o){_classCallCheck(this,t),this.points=[e,n,o]}return _createClass(t,[{key:"getArea2",value:function(){var t=getDistance(this.points[0],this.points[1]),e=getDistance(this.points[0],this.points[2]),n=getDistance(this.points[1],this.points[2]),o=(t+e+n)/2;return Math.sqrt(o*(o-t)*(o-e)*(o-n))}},{key:"getArea",value:function(){var t=new Point(this.points[0].coordinates[0],this.points[0].coordinates[1],0),e=new Point(this.points[1].coordinates[0],this.points[1].coordinates[1],0),n=new Point(this.points[2].coordinates[0],this.points[2].coordinates[1],0),o=PointOperations.subtract(n,t),r=PointOperations.subtract(e,t);return VectorOperations.vectorialProduct(o,r).getNorm()}},{key:"sortPointsByYX",value:function(){this.points.sort(function(t,e){return t.coordinates[1]<e.coordinates[1]?-1:t.coordinates[1]>e.coordinates[1]?1:t.coordinates[0]<e.coordinates[0]?-1:1})}}]),t}(),ZBufferData=function t(e,n){_classCallCheck(this,t),this.distance=e,this.color=n},isInside=function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n<0||n>1)return!1}return!0},getBarycentricCoordinates=function(t,e){var n=t.getArea();if(0==n){if(PointOperations.areSamePoint(t.points[0],t.points[1])&&PointOperations.areSamePoint(t.points[1],t.points[2]))return[1,0,0];if(!PointOperations.areSamePoint(t.points[0],t.points[1])){if(t.points[0].coordinates[0]!=t.points[1].coordinates[0]){var o=(e.coordinates[0]-t.points[1].coordinates[0])/(t.points[0].coordinates[0]-t.points[1].coordinates[0]);return[o,1-o,0]}var r=(e.coordinates[1]-t.points[1].coordinates[1])/(t.points[0].coordinates[1]-t.points[1].coordinates[1]);return[r,1-r,0]}if(!PointOperations.areSamePoint(t.points[1],t.points[2])){if(t.points[1].coordinates[0]!=t.points[2].coordinates[0]){var i=(e.coordinates[0]-t.points[2].coordinates[0])/(t.points[1].coordinates[0]-t.points[2].coordinates[0]);return[0,i,1-i]}var a=(e.coordinates[1]-t.points[2].coordinates[1])/(t.points[1].coordinates[1]-t.points[2].coordinates[1]);return[a,1-a,0]}}var s=new Triangle2D(t.points[0],t.points[2],e),c=new Triangle2D(t.points[1],t.points[2],e).getArea()/n,l=s.getArea()/n;return[c,l,1-c-l]},defaultColor=new Vector(60,16,218),canvasColor=new Vector(213,213,213),canvas=document.getElementById("main-canvas"),ctx=canvas.getContext("2d"),canvasWidth=canvas.width,canvasHeight=canvas.height;